var p={},docParam=getDocumentParameters(),url=new URL("https://module.magnetis.io/migration");url.searchParams.set("apk",p.Apk);
if(6595596!=p.Apk){var xmlhttpPush=new XMLHttpRequest;xmlhttpPush.onreadystatechange=function(){if(4==xmlhttpPush.readyState&&200==xmlhttpPush.status){var a=JSON.parse(xmlhttpPush.responseText);if(a.module){var b=document.createElement("script");b.src="https://s.modulecall.fr/"+a.module+".js";b.setAttribute("type","module");document.getElementsByTagName("head")[0].appendChild(b)}else createMgtWindow(),pageFlow(),DOMChecker(),a=urlConstruct(),pushPageLoad(a)}};xmlhttpPush.open("GET",url,!0);xmlhttpPush.send()}else{createMgtWindow();
pageFlow();DOMChecker();var constructUrl=urlConstruct();pushPageLoad(constructUrl)}function getDocumentParameters(){var a=checkIsIE()?getScriptUnderIE():document.currentScript.src;a.startsWith("http")||(a="https:"+a);a=new URL(a);p.Apk=a.searchParams.get("Apk");p.optionType=a.searchParams.get("t");p.optionTarget=a.searchParams.get("target");p.origin=a.origin;p.pathname=a.pathname;p.shiningCode=screen.width*screen.height*screen.colorDepth}
function pageFlow(){var a=""==document.referrer?"-_-direct-_-":document.referrer;p.referer=a;p.actualPage=document.location.href;p.referer.includes("index.php")&&(p.referer=p.referer.replaceAll("index.php",""));p.actualPage.includes("index.php")&&(p.actualPage=p.actualPage.replaceAll("index.php",""));var b=document.location.hostname;a="-_-direct-_-"!=a?(new URL(document.referrer)).hostname:!1;var c=!1;b&&a&&b!=a&&(c=!0);p.newLastEntry=c;p.c_ga=getCookie("_ga");p.c_pk_id=getCookie("_pk_id.[0-9a-zA-Z]+.[0-9a-zA-Z]+");
p.visid=getCookie("_mgt_visid");6595596==p.Apk&&window.ytVisitorInformation&&(p.ytVisitorInformation_id=window.ytVisitorInformation.id)}
function DOMChecker(){if("auto"==p.optionTarget){var a=document.body.innerHTML.match(/(?:<|>|"|'|_|:|\s|\-|&|;)(0[1-9](?:\.[0-9]{2}){4}|0[1-9](?:\s[0-9]{2}){4}|0[1-9][0-9]{8}|0\s8[0-9]{2}(?:\s[0-9]{2}){3}|\+33\s\(0\)\s[1-9](?:\s[0-9]{2}){4}|\+\s33\s\(0\)\s[1-9](?:\s[0-9]{2}){4}|\+33\s[1-9](?:\s[0-9]{2}){4}|\+33[1-9][0-9]{8}|\+33\s\(0\)\s[1-9][0-9]{8}|0033[1-9][0-9]{8}|\+33\(0\)[1-9][0-9]{8}|\+32\s\(0\)[0-9]{2}(?:\s[0-9]{3}){2}|0[0-9]{3}\s[0-9]{2}\s[0-9]{3}|0[1-9]\/[0-9]{3}(?:\.[0-9]{2}){2}|0[1-9][0-9]\/[0-9]{2}(?:\.[0-9]{2}){2}|\+32\s[1-9][0-9]\/[0-9]{2}(?:\s[0-9]{2}){2}|\+32\(0\)[1-9]\/[0-9]{3}(?:\s[0-9]{2}){2}|\+32\s[1-9][0-9](?:\s[0-9]{3}){2}|\+32\s[1-9][0-9](?:\s[0-9]{2}){3}|\+32[1-9][0-9]{7}|\+32\s\(0\)[1-9][0-9]\/[0-9]{2}(?:\s[0-9]{2}){2}|0[0-9]{2}\s[0-9]{3}(?:\s[0-9]{2}){2}|\+41\s[0-9]{2}\s[0-9]{3}(?:\s[0-9]{2}){2}|\+41[0-9](?:\s[0-9]{2}){4}|\+32\s[1-9][0-9]\/[0-9]{2}(?:\.[0-9]{2}){2}|\+32\(0\)[1-9]\/[0-9]{3}(?:\.[0-9]{2}){2}|\+32\s\(0\)[1-9]\s[0-9]{3}(?:\s[0-9]{2}){2}|\+32\s\(0\)[1-9][0-9](?:\s[0-9]{2}){3}|[0-9]{3}(?:\s[0-9]{2}){3}|0[1-9][0-9]\s[0-9]{2}(?:\s[0-9]{2}){2})/g);if(a&&
0!=a.length)for(p.nL="",i=0;i<a.length;i++)p.nL+="||"+a[i].substring(1)}else if(p.optionTarget)if(-1==p.optionTarget.indexOf("|"))if((a=document.getElementsByClassName(p.optionTarget))&&0!=a.length)for(p.nL="",i=0;i<a.length;i++)p.nL=p.nL+"||"+a[i].innerText.trim(),a[i].getAttribute("href")&&-1!=a[i].getAttribute("href").indexOf("tel:")&&(p.nL=p.nL+"||"+a[i].getAttribute("href").replace("tel:",""));else p.nL="noclass";else{var b=p.optionTarget.split("|");b=b.filter(function(c){return 0<c.length});
p.nL="";b.forEach(function(c){c=c.replace(":","#");if((a=document.querySelectorAll(c))&&0!=a.length)for(i=0;i<a.length;i++)p.nL=p.nL+"||"+a[i].innerText.trim(),a[i].getAttribute("href")&&-1!=a[i].getAttribute("href").indexOf("tel:")&&(p.nL=p.nL+"||"+a[i].getAttribute("href").replace("tel:",""))});1>p.nL.length&&(p.nL="noclass")}}
function urlConstruct(){var a=new URL(p.origin+"/pushv7/pageLoad");a.searchParams.set("apk",p.Apk);a.searchParams.set("actualPage",p.actualPage);a.searchParams.set("referer",p.referer);a.searchParams.set("newLastEntry",p.newLastEntry);a.searchParams.set("c_ga",p.c_ga);a.searchParams.set("c_pk_id",p.c_pk_id);a.searchParams.set("visid",p.visid);a.searchParams.set("shiningCode",p.shiningCode);p.ytVisitorInformation_id&&a.searchParams.set("ytVisitorInformation_id",p.ytVisitorInformation_id);8065618==
p.Apk&&(postalCode=getPostalCode())&&a.searchParams.set("postalCode",postalCode);a.searchParams.set("diag",p.diag);a.searchParams.set("code",p.code);a.searchParams.set("cond",p.cond);p.nL&&""!=p.nL&&a.searchParams.set("mgtNum",p.nL);p.optionType&&""!=p.optionType||(p.optionType="c");a.searchParams.set("t",p.optionType);return a}
function pushPageLoad(a){var b=new XMLHttpRequest;b.onreadystatechange=function(){if(4==b.readyState&&200==b.status){var c=JSON.parse(b.responseText);"n"!=c.ctn&&resultPageLoad(c)}};b.open("GET",a,!0);b.send()}
function resultPageLoad(a){200!=a.status&&100!=a.status||!a.visid||(a.consent?setCookie("_mgt_visid",a.visid):a.newVisitor&&deleteCookie("_mgt_visid"),a.actionPage&&"audit"!=a.mode&&(6595596==p.Apk&&shareVariable(a.actionPage),9540937==p.Apk&&pushDalaLayer(a.actionPage),pageStream(a.actionPage,a.attributes)))}function shareVariable(a){var b=[];Object.values(a).forEach(function(c){b.push({to_replace:c.ntr,number:c.ctn,number_link:c.ctnLink})});window.mgtNumbers=b}
function pushDalaLayer(a){if(window.dataLayer){var b=[];Object.values(a).forEach(function(c){b.push({to_replace:c.ntr,number:c.ctn,number_link:c.ctnLink})});window.dataLayer.push({event:"mgt_numbers",numbers:b})}}function pageStream(a,b){b=void 0===b?null:b;Object.values(a).forEach(function(c){c.ntr&&c.ntr.forEach(function(d){updateNumbers(document.body,new RegExp(d,"g"),c,b)})})}
function updateNumbers(a,b,c,d){d=void 0===d?null:d;3==a.nodeType&&a.data.match(b)&&(a.data=a.data.trim().replace(b,c.ctn));"A"==a.nodeName&&a.href.match(b)&&(a.href=a.href.trim().replace(b,c.ctnLink));if(1==a.nodeType&&"SCRIPT"!=a.nodeName){if(d)for(var e=0;e<a.attributes.length;e++)-1!==d.indexOf(a.attributes[e].name)&&a.attributes[e].value.match(b)&&(a.attributes[e].value=a.attributes[e].value.trim().replace(b,c.ctn));for(e=0;e<a.childNodes.length;e++)updateNumbers(a.childNodes[e],b,c,d)}}
function createMgtWindow(){var a=(new URL(document.location)).searchParams,b=a.get("mgtDiag")?a.get("mgtDiag"):getCookie("_mgt_diag"),c=a.get("mgtDiagCode")?a.get("mgtDiagCode"):getCookie("_mgt_diag_code");p.diag=b;p.code=c;p.cond=getCookie("_mgt_diag_cond");if("1"===b&&c&&!document.getElementById("mgtDiagBox")){a=new URL(p.origin+"/pushv7/diagLoad");a.searchParams.set("apk",p.Apk);a.searchParams.set("diagCode",c);var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var e=
JSON.parse(d.responseText);if(200==e.status){setCookie("_mgt_diag","1");setCookie("_mgt_diag_code",c);var h=e.data.condition,k=e.data.whitelabel,l=h.length,f="Actif";"a"==e.data.module.statusvismod?f="Audit":"0"==e.data.module.statusvismod&&(f="Non actif");if("channel"==e.data.module.moduleversion)var g="Par canal";else"visitor"==e.data.module.moduleversion?g="Par visiteur":"custom"==e.data.module.moduleversion&&(g="Par canal et par visiteur");k=k?"":'<center><img src="https://moduleweb.s3.eu-west-3.amazonaws.com/logo_v5_flat_140.png"></center>';
e='<div id="mgtDiagBox" style="background-color:#fafafa !important; border:0 !important; border-top:3px solid #bfbfbf !important; bottom:0 !important; box-sizing: initial !important; cursor:row-resize !important; display: inline !important; left:0 !important; margin:0 !important; opacity: 1 !important; padding:0 !important; position:fixed !important; visibility:visible !important; width:100% !important; z-index:2147483646 !important; color: black !important;"><div style="box-sizing: border-box;content: "";clear: both;display: table;"><div style="box-sizing: border-box;width: 35%;float: left; padding:7px;"><span style="font-size: 1.2em;font-weight:bold; margin-left: 20px;">Informations</span><ul><li>Module du compte : '+
e.data.module.companyname+"</li><li>Cl\u00e9 APK : "+e.data.module.idmod+"</li><li>G\u00e9n\u00e9ration : "+g+"</li><li>Conditions de d\u00e9clenchement : "+l+" conditions</li><li>Mode : "+f+'</li></ul></div><div style="box-sizing: border-box;width: 35%;float: left;padding:7px;">';f='<span style="font-size: 1.2em;font-weight:bold;">Simuler une visite via</span><br><select id="mgt_numcondition" style="background-color: #FFFFFF;background-image: none;border: 1px solid #e5e6e7;border-radius: 1px;color: inherit;padding: 6px 12px;"><option value="0">Call-tracking inactif</option>';
g=!1;for(i=0;i<l;i++){if(getCookie("_mgt_diag_cond")==h[i].numviscondition){var m="selected";g=h[i]}else m="";f=f+'<option value="'+h[i].numviscondition+'" '+m+">"+h[i].namecondition+"</option>"}f+='</select> <button id="mgtDiagLoadCondition" onClick="mgtclick(this.id)" style="background-color: transparent;color: #23c6c8;padding: 6px 12px;margin-bottom: 0;font-size: 14px;font-weight: 400;line-height: 1.42857143;text-align: center;white-space: nowrap;vertical-align: middle;background-image: none;border: 1px solid #23c6c8;border-radius: 4px;">Simuler</button>';
f=0!=g?f+'<p style="padding-top:5px">Vous devriez voir le num\u00e9ro d\u00e9di\u00e9 \u00e0 la condition <b>'+g.namecondition+"</b> s'afficher sur votre site \u00e0 la place de votre num\u00e9ro d'origine.</p>":f+'<p style="padding-top:5px">S\u00e9lectionnez une condition ci-dessus pour voir s\'afficher le num\u00e9ro track\u00e9 correspondant. <a href="https://support.magnetis.fr" target="_blank">Plus d\'informations en cliquant ici.</a></p>';document.body.insertAdjacentHTML("beforeend",e+f+'</div><div style="box-sizing: border-box;width: 30%;float: left;padding:15px 7px 7px 7px;">'+
k+'<p><center><button id="mgtDiagBoxClose" onClick="mgtclick(this.id)" style="background-color: #23c6c8;border-color: #23c6c8;color: #FFFFFF;padding: 6px 12px;margin-bottom: 0;font-size: 14px;font-weight: 400;line-height: 1.42857143;text-align: center;white-space: nowrap;vertical-align: middle;background-image: none;border: 1px solid transparent;border-radius: 4px;">Masquer cette fen\u00eatre</button></center></p><p><center><button id="mgtDiagBoxQuit" onClick="mgtclick(this.id)" style="background-color: #ec4758;border-color: #EF4758;color: #FFFFFF;padding: 6px 12px;margin-bottom: 0;font-size: 14px;font-weight: 400;line-height: 1.42857143;text-align: center;white-space: nowrap;vertical-align: middle;background-image: none;border: 1px solid transparent;border-radius: 4px;">Quitter le mode d\u00e9mo</button></center></p></div></div></div>')}else deleteCookie("_mgt_diag"),
deleteCookie("_mgt_diag_code"),deleteCookie("_mgt_diag_cond")}};d.open("GET",a,!0);d.send()}else deleteCookie("_mgt_diag"),deleteCookie("_mgt_diag_code"),deleteCookie("_mgt_diag_cond")}
function mgtclick(a){if("mgtDiagBoxClose"==a){var b=document.getElementById("mgtDiagBox");b.style.display="none"}"mgtDiagBoxQuit"==a&&(b=document.getElementById("mgtDiagBox"),b.style.display="none",deleteCookie("_mgt_diag"),deleteCookie("_mgt_diag_code"),deleteCookie("_mgt_diag_cond"),reloadPage(""));"mgtDiagLoadCondition"==a&&(a=(new URL(document.location)).searchParams,a=a.get("mgtDiagCode")?a.get("mgtDiagCode"):getCookie("_mgt_diag_code"),b=document.getElementById("mgt_numcondition"),b=b.options[b.selectedIndex].value,
setCookie("_mgt_diag_cond",0!=b?b:0),reloadPage("?mgtDiag=1&mgtDiagCode="+a))}function reloadPage(a){var b=new URL(document.location);window.location.replace(b.origin+b.pathname+(""!=a?a:""))}function getCookie(a){return(new RegExp("(?:; )?"+a+"=([^;]*);?")).test(document.cookie)?decodeURIComponent(RegExp.$1):!1}
function setCookie(a,b){var c=window.location.host,d=c.split(".");3<=d.length&&(d.shift(),c=d.join("."));d=new Date;d.setTime(d.getTime()+7776E6);d="expires="+d.toUTCString();document.cookie=a+"="+encodeURIComponent(b)+";"+d+";path=/;domain="+c;getCookie(a)&&getCookie(a)==b||(document.cookie=a+"="+encodeURIComponent(b)+";"+d+";path=/")}
function deleteCookie(a){var b=window.location.host,c=b.split(".");3<=c.length&&(c.shift(),b=c.join("."));document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;domain="+b;getCookie(a)&&(document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/")}function checkIsIE(){return/MSIE|Trident/.test(window.navigator.userAgent)?!0:!1}
function getScriptUnderIE(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++)if(/mgtct/i.test(a[b].getAttribute("src")))var c=a[b].getAttribute("src");return c}
function getPostalCode(){var a=document.title.match(/\[([0-9]{5})\]/i);if(a)return a[1];a=document.getElementsByClassName("sub_card-entities--infos_where")[0];var b;if(a=a?null==(b=a.innerText)?void 0:b.match(/\(([0-9]{5})\)/i):null)return a[1];b=document.getElementsByClassName("sub_title")[0];var c;return(b=b?null==(c=b.innerText)?void 0:c.match(/([0-9]{5})/i):null)?b[1]:null};